<meta charset="UTF-8">
<div class="col-sm-12 ">
	<form role="form-vertical" name="formDiaria" ng-submit="ctrl.submit()">
		<br>
		<div class="row">		
		<div class="col-sm-4">
		Selecione o Tipo:
			<select class="form-control" ng-model="ctrl.itemDiaria.tipo" ng-options="tipo for tipo in ctrl.tipos track by tipo">
			</select>
		</div>
			
		</div>
		<br>
		<div class="row ">
			<div class="col-sm-6 ">
				Nome:{{ctrl.funcionario.contaFuncionario.funcionario.pessoa.nomeCompleto}}
			</div>
			<div class="col-sm-6 ">
				Total:{{ctrl.funcionario.totalValorDiaria | currency}}</div>
		</div>
		<div class="row ">
			<br> <span class="input-group-btn"> <a type="button"
				data-toggle="modal" data-target="#informacaoModal"
				data-whatever="@mdo" class="btn btn-info btn-flat">Informações <i
					class="glyphicon glyphicon-search"></i></a>
			</span> <span class="input-group-btn"> <a type="button"
				data-toggle="modal" data-target="#itensDiariaModal"
				data-whatever="@mdo" class="btn btn-info btn-flat">Diárias
					lançadas <i class="glyphicon glyphicon-search"></i>
			</a>
			</span>

		</div>
		<br>
		<div class="row">
			<div class="label-control">Destino</div>
			<div class="col-sm-4">
				<div class="input-group margin">
					<md-autocomplete md-no-cache="ctrl.noCache"
						md-selected-item="ctrl.itemDiaria.estado"
						md-search-text="busca"
						md-selected-item-change="ctrl.buscarCidades(ctrl.itemDiaria.estado.id)"
						md-items=" estado in ctrl.estados | filter : busca"
						md-item-text="estado.nome" md-min-length="0"
						placeholder="buscar"> <md-item-template>
					<span md-highlight-text="busca" md-highlight-flags="^i">{{estado.nome}}</span>
					</md-item-template> </md-autocomplete>				
					<span class="input-group-btn"> <a type="button"
						class="btn btn-info btn-flat"><i>Estado</i></a>
					</span>
				</div>
			</div>
			<div class="col-sm-4">
				<div class="input-group margin">
				<md-autocomplete md-no-cache="ctrl.noCache"
						md-selected-item="ctrl.localDeslocamento"
						md-search-text="buscarCidade"
						md-selected-item-change="ctrl.adicionarLocal(ctrl.localDeslocamento)"
						md-items=" cidade in ctrl.cidades | filter : buscarCidade"
						md-item-text="cidade.nome" md-min-length="0"
						placeholder="buscar"> <md-item-template>
					<span md-highlight-text="buscarCidade" md-highlight-flags="^i">{{cidade.nome}}</span>
					</md-item-template> </md-autocomplete>
				 <span class="input-group-btn"> <a type="button"
						class="btn btn-info btn-flat"><i>Cidade</i></a>
					</span>
				</div>
			</div>
			<div ng-repeat="cidade in localDeslocamentos">
				<div class="col-sm-1"><br>
					<span ng-click="ctrl.removerLocal(cidade)" class="label label-default">{{cidade.nome}}</span>
				</div>			
			</div>			
			
			
		</div>
		<br>
		<div class="row">
		<div class="col-sm-4">
		Código:
				<div class="input-group margin">
					<select class="form-control select2"
						ng-model="ctrl.itemDiaria.codigoLocalDeslocamento"
						ng-options="valor.codigo for valor in ctrl.valoresDiaria track by valor.id"
						required>
						<option value=""></option>
					</select> <span class="input-group-btn"> <a type="button"
						data-toggle="modal" data-target="#codigoModal"
						data-whatever="@mdo" class="btn btn-info btn-flat"><i>Código</i></a>
					</span>
				</div>
			</div>
			<div class="col-sm-4">
				Transporte Saída:
				<div class="input-group margin">
					<input type="text" class="form-control text-uppercase"
						ng-model="ctrl.itemDiaria.meioTransporteSaida.placa" required>
					<span class="input-group-btn"> <a type="button"
						class="btn btn-info btn-flat" data-toggle="modal"
						data-target="#transporteSaidaModal"><i
							class="fa fa-automobile"></i></a>
					</span>
				</div>
			</div>
			<div class="col-sm-4">
			
				Retorno:
				<div class="input-group margin">
					<input type="text" class="form-control text-uppercase"
						ng-model="ctrl.itemDiaria.meioTransporteRetorno.placa" required>
					<span class="input-group-btn"> <a type="button"
						class="btn btn-info btn-flat" data-toggle="modal"
						data-target="#transporteRetornoModal"><i
							class="fa fa-automobile"></i></a>
					</span>
				</div>
			</div>
		</div>
		<br>
		<div class="row">
			<div class="label-control">Datas</div>
			<div class="col-sm-3">
				Data Saida:
				<p class="input-group">
					<input type="text" class="form-control" readonly
						uib-datepicker-popup="{{format}}" date-input
						ng-model="ctrl.itemDiaria.dataSaida" is-open="saida.opened"
						ng-required="true" close-text="Close" required /> <span
						class="input-group-btn">
						<button type="button" class="btn btn-default"
							ng-click="saidaOpen()">
							<i class="glyphicon glyphicon-calendar"></i>
						</button>
					</span>
				</p>
			</div>

			<div class="col-sm-1">Horário Saida:</div>
			<div class="col-sm-2">
				<div uib-timepicker ng-model="ctrl.itemDiaria.horaSaida"
					hour-step="1" minute-step="1" show-meridian="false"></div>

			</div>
			<div class="col-sm-3">
				Data Chegada:
				<p class="input-group">
					<input type="text" class="form-control" readonly
						uib-datepicker-popup="{{format}}" date-input
						ng-model="ctrl.itemDiaria.dataChegada"
						ng-change="ctrl.verificaDataFinal(ctrl.itemDiaria.dataSaida, ctrl.itemDiaria.dataChegada )"
						is-open="chegada.opened" ng-required="true" close-text="Close"
						required /> <span class="input-group-btn">
						<button type="button" class="btn btn-default"
							ng-click="chegadaOpen()">
							<i class="glyphicon glyphicon-calendar"></i>
						</button>
					</span>
				</p>
			</div>

			<div class="col-sm-1">Horário Chegada:</div>
			<div class="col-sm-2">
				<div uib-timepicker ng-model="ctrl.itemDiaria.horaChegada"
					hour-step="1" minute-step="1" show-meridian="false"></div>
			</div>
		</div>
		<div class="row ">
			<br>
			<div class="form-group">
				<label for="message-text" class="control-label">Motivo:</label>
				<textarea class="form-control"
					ng-model="ctrl.itemDiaria.motivo" id="message-text"></textarea>
			</div>
		</div>
		<div class="row ">
			<br> <span class="input-group-btn"> <a type="button"
				data-toggle="modal" data-target="#passagemModal"
				data-whatever="@mdo" class="btn btn-info btn-flat">Passagem<i
					class="fa fa-bus"></i></a>
			</span>
		</div>
		<br>
		<div class="row ">
			<div class="col-sm-4"></div>
			<div class="col-sm-4">
				<button id="submit"
					ng-disabled="!ctrl.itemDiaria.estado || !ctrl.localDeslocamento || !ctrl.itemDiaria.codigoLocalDeslocamento || !ctrl.itemDiaria.tipo ||
					!ctrl.itemDiaria.meioTransporteSaida.placa || !ctrl.itemDiaria.meioTransporteRetorno.placa ||  !ctrl.itemDiaria.dataSaida
					|| !ctrl.itemDiaria.horaSaida || !ctrl.itemDiaria.dataChegada || !ctrl.itemDiaria.horaChegada || !ctrl.itemDiaria.motivo"
					class="btn btn-lg btn-primary btn-block btn-signin">{{botao}}</button>
			</div>
		</div>

	</form>
</div>

<!-- INICIO  modal do informaçoes da codigo -->
<div class="modal fade bs-example-modal-lg modal-primary"
	id="codigoModal" tabindex="-1" role="dialog"
	aria-labelledby="exampleModalLabel">
	<div class="modal-dialog modal-lg" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal"
					aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
				<h4 class="modal-title" id="exampleModalLabel">Informações dos
					valores Por Local</h4>
			</div>
			<div class="modal-body">
				<div class="row">
					<div class="col-sm-12">
						<h3>Valores das Diarias por localidade:</h3>
						<br>
						<div ng-repeat="valor in ctrl.valoresDiaria">
							<div class="row">
								<div class="col-sm-1">
									<h4>código</h4>
									<h3>{{valor.codigo}}</h3>
								</div>
								<div class="col-sm-11">
									<h4>Local</h4>
									<h6>{{valor.deslocamento}}</h6>
								</div>
							</div>

							<div class="row">
								<div class="col-sm-2">
									alojamento
									<h4>{{valor.alojamento | currency}}</h4>
								</div>
								<div class="col-sm-2">
									valor pernoite
									<h4>{{valor.pernoite | currency}}</h4>
								</div>
								<div class="col-sm-2">
									13:00 às 19:00
									<h4>{{valor.retornoTrezeAsDezenove | currency}}</h4>
								</div>
								<div class="col-sm-2">
									após 19:00
									<h4>{{valor.retornoAposDezenove | currency}}</h4>
								</div>
								<div class="col-sm-2">
									6:00 às 12:00
									<h4>{{valor.deslocamentoSeisAsDoze | currency}}</h4>
								</div>
								<div class="col-sm-2">
									mais de 12:00
									<h4>{{valor.deslocamentoMaisDeDoze | currency}}</h4>
								</div>
							</div>
							<br>
							<hr>
							<br>
						</div>
					</div>
				</div>

			</div>
			<div class="modal-footer ">
				<button type="button" class="btn btn-default" data-dismiss="modal">Fechar</button>
			</div>
		</div>
	</div>
</div>
<!-- FIM  modal do informaçoes da codigo -->
<!-- INICIO  modal do informaçoes da diaria -->
<div class="modal fade bs-example-modal-lg modal-primary"
	id="informacaoModal" tabindex="-1" role="dialog"
	aria-labelledby="exampleModalLabel">
	<div class="modal-dialog modal-lg" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal"
					aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
				<h4 class="modal-title" id="exampleModalLabel">Diária
					{{ctrl.diaria.mes}}</h4>
			</div>
			<div class="modal-body">
				<div class="row">
					<br>
					<div class="col-sm-12">
						<h3>Observação:</h3>
						<br>
						<h4>{{ctrl.diaria.observacao}}</h4>
					</div>
				</div>
				<br>
				<div class="row">
					<div class="col-sm-6">
						<h3>Data Abertura:</h3>
						<br>
						<h4>{{ctrl.diaria.dataAbertura | date : 'dd/MM/yyyy'}}</h4>
					</div>
					<div class="col-sm-6">
						<h3>Valor UFESP:</h3>
						<br>
						<h4>{{ctrl.diaria.valorUfesp | currency}}</h4>
					</div>
				</div>
				<br>
				<hr>
				<br>
			</div>
			<div class="modal-footer ">
				<button type="button" class="btn btn-default" data-dismiss="modal">Fechar</button>
			</div>
		</div>
	</div>
</div>
<!-- FIM  modal do informaçoes da diaria -->
<!-- INICIO modal passagem-->
<div class="modal fade modal-default" id="passagemModal" tabindex="-1"
	role="dialog" aria-labelledby="exampleModalLabel">
	<div class="modal-dialog" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal"
					aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
				<h4 class="modal-title" id="exampleModalLabel">Adicione os
					dados da passagem</h4>
			</div>
			<div class="modal-body">
				<div class="form-group">
					Valor da Passagem
					<div class="input-group margin col-sm-3">
						<input type="text" class="form-control select2"
							ng-model="ctrl.itemDiaria.valorPassagem" ui-money-mask> <span
							class="input-group-btn"> <a type="button"
							class="btn btn-info btn-flat"><i>R$</i></a>
						</span>
					</div>

					<label for="texto" class="control-label">Observações:</label> <input
						type="text" class="form-control"
						ng-model="ctrl.itemDiaria.observacaoPassagem" id="texto">



				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-primary" data-dismiss="modal">Adicionar</button>
			</div>
		</div>
	</div>
</div>
<!-- FIM modal do passagem-->

<!-- INICIO  modal do meio de Transporte Saida-->
<div class="modal fade bs-example-modal-lg modal-default"
	id="transporteSaidaModal" tabindex="-1" role="dialog"
	aria-labelledby="exampleModalLabel">
	<div class="modal-dialog modal-lg" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal"
					aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
				<h4 class="modal-title" id="exampleModalLabel">Adicione o meio
					de trasnporte</h4>
			</div>
			<div class="modal-body">
				<div class="row">
					<div class="col-sm-4">
						<!-- coordenadoria -->
						<div class="input-group margin">
							<select class="form-control select2"
								ng-model="ctrl.coordenadoria"
								ng-options="coordenadoria.mnemonico for coordenadoria in ctrl.coordenadorias track by coordenadoria.id">
								<option value=""></option>
							</select> <span class="input-group-btn"> <a type="button"
								class="btn btn-primary btn-flat"><i class="fa fa-home"></i></a>
							</span>
						</div>
					</div>
					<div class="col-sm-4" ng-if="ctrl.coordenadoria">
						<!-- tipo unidade -->
						<div class="input-group margin">
							<select class="form-control select2" ng-model="ctrl.tipo"
								ng-change="ctrl.buscarUnidades(ctrl.tipo.id)"
								ng-options="tipo.descricao for tipo in ctrl.tiposUnidade track by tipo.id">
								<option value=""></option>
							</select> <span class="input-group-btn"> <a type="button"
								class="btn btn-default btn-flat"><i
									class="fa fa-lightbulb-o"></i></a>
							</span>
						</div>
					</div>
					<div class="col-sm-4" ng-if="ctrl.tipo">
						<!-- unidade -->
						<div class="input-group margin">
							<select class="form-control select2" ng-model="ctrl.unidade"
								ng-change="ctrl.buscarVeiculos(ctrl.unidade.id)"
								ng-options="unidade.dadosUnidade.mnemonico for unidade in ctrl.unidades track by unidade.id">
								<option value=""></option>
							</select> <span class="input-group-btn"> <a type="button"
								class="btn btn-info btn-flat"><i class="fa fa-eye"></i></a>
							</span>
						</div>
					</div>
				</div>
				<div class="row" ng-if="ctrl.unidade">
					<div class="col-sm-4">
						<!-- veiculo -->
						<div class="input-group margin">
							<select class="form-control select2"
								ng-model="ctrl.itemDiaria.meioTransporteSaida"
								ng-options="veiculo.placa for veiculo in ctrl.veiculos ">
								<option value=""></option>
							</select> <span class="input-group-btn"> <a type="button"
								class="btn btn-success btn-flat"><i class="fa fa-automobile"></i></a>
							</span>
						</div>
					</div>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-primary" data-dismiss="modal">Adicionar</button>
			</div>
		</div>
	</div>
</div>
<!-- FIM  modal do meio de Transporte Saida-->

<!-- INICIO  modal do meio de Transporte Retorno-->
<div class="modal fade bs-example-modal-lg modal-default"
	id="transporteRetornoModal" tabindex="-1" role="dialog"
	aria-labelledby="exampleModalLabel">
	<div class="modal-dialog modal-lg" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal"
					aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
				<h4 class="modal-title" id="exampleModalLabel">Adicione o meio
					de trasnporte</h4>
			</div>
			<div class="modal-body">
				<div class="row">
					<div class="col-sm-4">
						<!-- coordenadoria -->
						<div class="input-group margin">
							<select class="form-control select2"
								ng-model="ctrl.coordenadoria"
								ng-options="coordenadoria.mnemonico for coordenadoria in ctrl.coordenadorias track by coordenadoria.id ">
								<option value=""></option>
							</select> <span class="input-group-btn"> <a type="button"
								class="btn btn-primary btn-flat"><i class="fa fa-home"></i></a>
							</span>
						</div>
					</div>
					<div class="col-sm-4" ng-if="ctrl.coordenadoria">
						<!-- tipo unidade -->
						<div class="input-group margin">
							<select class="form-control select2" ng-model="ctrl.tipo"
								ng-change="ctrl.buscarUnidades(ctrl.tipo.id)"
								ng-options="tipo.descricao for tipo in ctrl.tiposUnidade track by tipo.id">
								<option value=""></option>
							</select> <span class="input-group-btn"> <a type="button"
								class="btn btn-default btn-flat"><i
									class="fa fa-lightbulb-o"></i></a>
							</span>
						</div>
					</div>
					<div class="col-sm-4" ng-if="ctrl.tipo">
						<!-- unidade -->
						<div class="input-group margin">
							<select class="form-control select2" ng-model="ctrl.unidade"
								ng-change="ctrl.buscarVeiculos(ctrl.unidade.id)"
								ng-options="unidade.dadosUnidade.mnemonico for unidade in ctrl.unidades  track by unidade.id">
								<option value=""></option>
							</select> <span class="input-group-btn"> <a type="button"
								class="btn btn-info btn-flat"><i class="fa fa-eye"></i></a>
							</span>
						</div>
					</div>
				</div>
				<div class="row" ng-if="ctrl.unidade">
					<div class="col-sm-4">
						<!-- veiculo -->
						<div class="input-group margin">
							<select class="form-control select2"
								ng-model="ctrl.itemDiaria.meioTransporteRetorno"
								ng-options="veiculo.placa for veiculo in ctrl.veiculos track by veiculo.id">
								<option value=""></option>
							</select> <span class="input-group-btn"> <a type="button"
								class="btn btn-success btn-flat"><i class="fa fa-automobile"></i></a>
							</span>
						</div>
					</div>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-primary" data-dismiss="modal">Adicionar</button>
			</div>
		</div>
	</div>
</div>
<!-- FIM  modal do meio de Transporte Retorno-->
<!-- INICIO  modal itens lançados-->
<div class="modal fade bs-example-modal-lg modal-info"
	id="itensDiariaModal" tabindex="-1" role="dialog"
	aria-labelledby="exampleModalLabel">
	<div class="modal-dialog modal-lg" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal"
					aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
				<h4 class="modal-title" id="exampleModalLabel">Diarias lançadas</h4>
			</div>
			<div class="modal-body"></div>
			<div class="col-sm-3">
				<input class="form-control" type="text" placeholder="Pesquisar..."
					ng-model="buscar">
			</div>

			<table class="table table-hover table-bordered"
				ng-controller="ItemDiariaEditarController as ctrlEditar">
				<thead>
					<tr>
						<td>Localidade</td>
						<td>Data Saida</td>
						<td>Data Chegada</td>
						<td>Hora Saída</td>
						<td>Hora Chegada</td>
						<td>Valor</td>
						<td>Transp. saida</td>
						<td>Transp. retorno</td>
						<td>Codigo Desl.</td>

					</tr>
				</thead>
				<tbody
					ng-repeat=" item in itens | filter : buscar |  orderBy : '-id'">
					<tr>
						<td>
							<div ng-repeat="cidade in item.localDeslocamentos" >							
							{{ cidade.nome }}&nbsp;<a ng-if="item.localDeslocamentos.length > 0">/</a>&nbsp;
							</div>
						</td>
						<td>{{ item.dataSaida | date : 'dd/MM/yyyy'}}</td>
						<td>{{ item.dataChegada | date : 'dd/MM/yyyy'}}</td>
						<td>{{ item.horaSaida | date : 'HH:mm'}}</td>
						<td>{{ item.horaChegada | date : 'HH:mm'}}</td>
						<td>{{ item.valorDiaria | currency }}</td>
						<td>{{ item.meioTransporteSaida }}</td>
						<td>{{ item.meioTransporteRetorno}}</td>
						<td>{{ item.codigoLocalDeslocamento.codigo }}</td>
						<td ng-if="item.analizado"><button disabled class="btn btn-success">Analizado</button></td>
						<td ng-show="ctrl.editar"  ng-if="!item.analizado"><a href="" data-dismiss="modal"
							ng-click="ctrlEditar.proximaPagina(item)" title="teste"><i
								class="glyphicon glyphicon-edit"></i></a></td>
						<td ng-show="ctrl.editar"  ng-if="!item.analizado"><a href=""
							ng-click="ctrl.excluir(item)"><i
								class="glyphicon glyphicon-remove"></i></a></td>
					</tr>
				</tbody>
			</table>

			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Fechar</button>
			</div>
		</div>
	</div>
</div>
<!-- FIM  modal itens lançados-->